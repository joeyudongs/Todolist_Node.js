(this.webpackJsonphomework2=this.webpackJsonphomework2||[]).push([[0],{103:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(22),s=a.n(r),o=(a(77),a(6)),i=a(11),d=a(56);function u(e,t){switch(t.type){case"LOGIN":case"REGISTER":return{username:t.username,access_token:t.access_token};case"LOGOUT":return{username:t.username,access_token:void 0};default:return e}}function j(e,t){switch(t.type){case"CREATE_TODO":return[{id:t.id,title:t.title,content:t.content,author:t.author,complete:!1,completedOn:(new Date).toLocaleDateString("en-us").toString()}].concat(Object(d.a)(e));case"TOGGLE_TODO":return e.map((function(e){return e._id===t.todoId&&(e.complete=t.complete,e.completeOn=t.completeOn),e}));case"DELETE_TODO":return e.filter((function(e){return e._id!==t.todoId}));case"FETCH_TODOS":return t.todos;case"FETCH_TODOS_BY_USER":return e.filter((function(e){return e.author===t.author.username}));default:return e}}function l(e,t){return"FETCH_USERS"===t.type?t.users:e}function b(e,t){return{user:u(e.user,t),todos:j(e.todos,t),users:l(e.users,t)}}var O=a(8),h=a(2),f=a(10),x=a(111),p=a(109),m=a(106),g=a(1);var v=function(e){var t=e.show,a=e.handleClose,c=(Object(n.useContext)(O.a).dispatch,Object(n.useState)({username:"",password:"",passwordRepeat:""})),r=Object(o.a)(c,2),s=r[0],i=r[1],d=Object(n.useState)(""),u=Object(o.a)(d,2),j=(u[0],u[1]),l=Object(f.b)((function(e,t){return{url:"auth/register",method:"POST",data:{username:e,password:t,passwordConfirmation:t}}})),b=Object(o.a)(l,2),v=b[0],C=b[1];return Object(n.useEffect)((function(){v&&!1===v.isLoading&&(v.data||v.error)&&(v.error?(console.log(v),j("Registration failed, please try again later."),alert("fail")):(console.log(v),j("Registration successful. You may now login."),alert("success")))}),[v]),Object(g.jsx)(x.a,{show:t,onHide:a,children:Object(g.jsxs)(p.a,{onSubmit:function(e){e.preventDefault(),C(s.username,s.password),a()},children:[Object(g.jsx)(x.a.Header,{closeButton:!0,children:Object(g.jsx)(x.a.Title,{children:"Register"})}),Object(g.jsxs)(x.a.Body,{children:[Object(g.jsx)(p.a.Label,{htmlFor:"register-username",children:"Username:"}),Object(g.jsx)(p.a.Control,{type:"text",value:s.username,onChange:function(e){return i(Object(h.a)(Object(h.a)({},s),{},{username:e.target.value}))},name:"register-username",id:"register-username"}),Object(g.jsx)(p.a.Label,{htmlFor:"register-password",children:"Password:"}),Object(g.jsx)(p.a.Control,{type:"password",name:"register-password",id:"register-password",value:s.password,onChange:function(e){return i(Object(h.a)(Object(h.a)({},s),{},{password:e.target.value}))}}),Object(g.jsx)(p.a.Label,{htmlFor:"register-password-repeat",children:"Repeat password:"}),Object(g.jsx)(p.a.Control,{type:"password",name:"register-password-repeat",id:"register-password-repeat",value:s.passwordRepeat,onChange:function(e){return i(Object(h.a)(Object(h.a)({},s),{},{passwordRepeat:e.target.value}))}})]}),Object(g.jsxs)(x.a.Footer,{children:[Object(g.jsx)(m.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(g.jsx)(m.a,{variant:"primary",type:"submit",disabled:0===s.username.length||0===s.password.length||s.password!==s.passwordRepeat,children:"Register"})]})]})})};var C=function(e){var t=e.show,a=e.handleClose,c=Object(n.useContext)(O.a).dispatch,r=Object(n.useState)(""),s=Object(o.a)(r,2),i=s[0],d=s[1],u=Object(n.useState)(!1),j=Object(o.a)(u,2),l=j[0],b=j[1],h=Object(n.useState)(""),v=Object(o.a)(h,2),C=v[0],w=v[1],y=Object(f.b)((function(e,t){return{url:"auth/login",method:"POST",data:{username:e,password:t}}})),T=Object(o.a)(y,2),E=T[0],k=T[1];return Object(n.useEffect)((function(){E&&!1===E.isLoading&&(E.data||E.error)&&(E.error?(b(!0),alert("failed")):(b(!1),console.log(E.data),c({type:"LOGIN",username:i,access_token:E.data.access_token})))}),[E]),Object(g.jsx)(x.a,{show:t,onHide:a,children:Object(g.jsxs)(p.a,{onSubmit:function(e){e.preventDefault(),k(i,C),a()},children:[Object(g.jsx)(x.a.Header,{closeButton:!0,children:Object(g.jsx)(x.a.Title,{children:"Login"})}),Object(g.jsxs)(x.a.Body,{children:[Object(g.jsx)(p.a.Label,{htmlFor:"login-username",children:"Username:"}),Object(g.jsx)(p.a.Control,{type:"text",value:i,onChange:function(e){d(e.target.value)},name:"login-username",id:"login-username"}),Object(g.jsx)(p.a.Label,{htmlFor:"login-password",children:"Password:"}),Object(g.jsx)(p.a.Control,{type:"password",name:"login-password",value:C,onChange:function(e){w(e.target.value)},id:"login-password"}),Object(g.jsx)("input",{type:"submit",value:"Login"}),l&&Object(g.jsx)(p.a.Text,{style:{color:"red"},children:"Invalid username or password"})]}),Object(g.jsxs)(x.a.Footer,{children:[Object(g.jsx)(m.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(g.jsx)(m.a,{variant:"primary",onClick:0===i.length,type:"submit",children:"Login"})]})]})})};var w=function(){var e=c.a.lazy((function(){return a.e(3).then(a.bind(null,113))})),t=Object(n.useState)(!1),r=Object(o.a)(t,2),s=r[0],i=r[1],d=Object(n.useState)(!1),u=Object(o.a)(d,2),j=u[0],l=u[1];return Object(n.useContext)(O.a).state.user.username?Object(g.jsx)(e,{}):Object(g.jsxs)("div",{className:"justify-content-end",children:[Object(g.jsx)(m.a,{style:{marginRight:6},variant:"primary",onClick:function(e){return i(!0)},children:"Login"}),Object(g.jsx)(C,{show:s,handleClose:function(){return i(!1)}}),Object(g.jsx)(m.a,{variant:"primary",onClick:function(e){return l(!0)},children:"Register"}),Object(g.jsx)(v,{show:j,handleClose:function(){return l(!1)}})]})},y=a(12),T=a(110),E=a(107),k=a(108),S=a.p+"static/media/logo.5d3c89ce.png",_=a.p+"static/media/header.4ae3d5cd.png";var L=function(e){e.setTheme;var t=Object(n.useContext)(O.a).state.user,a={backgroundImage:"url(".concat(_,")")};return Object(g.jsx)("div",{children:Object(g.jsx)(T.a,{bg:"light",expand:"lg",style:a,children:Object(g.jsxs)(E.a,{children:[Object(g.jsx)(T.a.Brand,{href:"/",children:Object(g.jsx)("img",{src:S,width:"56",height:"50",className:"d-inline-block align-top",alt:"Sebastian's Todo List"})}),Object(g.jsx)(T.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(g.jsxs)(T.a.Collapse,{id:"basic-navbar-nav",children:[Object(g.jsx)(k.a,{className:"me-auto",children:t.username&&Object(g.jsx)(k.a.Link,{children:Object(g.jsx)(y.a,{href:"/todo/create",children:"Create New Todo"})})}),Object(g.jsx)(c.a.Suspense,{fallback:"Loading...",children:Object(g.jsx)(w,{})})]})]})})})},D=a(112);function R(e){var t=e.title,a=e.content,c=e.author,r=e.completedOn,s=e.complete,i=e.todoId,d=e.short,u=void 0!==d&&d,j=Object(n.useContext)(O.a),l=j.state,b=j.dispatch;console.log("todoId is: "+i);var h=Object(f.b)((function(){return{url:"/todo/".concat(i),method:"delete",headers:{Authorization:"".concat(l.user.access_token)}}})),x=Object(o.a)(h,2),p=x[0],v=x[1],C=Object(f.b)((function(e,t){return{url:"/todo/".concat(e),method:"put",headers:{Authorization:"".concat(l.user.access_token)},data:{complete:t,completedOn:Date.now()}}})),w=Object(o.a)(C,2),T=w[0],E=w[1];Object(n.useEffect)((function(){console.log("deletedTodo is: "+p),p&&p.data&&!1===p.isLoading&&b({type:"DELETE_TODO",todoId:p.data._id})}),[p]),Object(n.useEffect)((function(){T&&T.data&&!1===T.isLoading&&b({type:"TOGGLE_TODO",complete:T.data.complete,completedOn:T.data.completeOn,todoId:T.data._id})}),[T]);var k=a;return u&&a.length>30&&(k=a.substring(0,30)+"..."),Object(g.jsx)(D.a,{children:Object(g.jsxs)(D.a.Body,{children:[Object(g.jsx)(D.a.Title,{children:Object(g.jsx)(y.a,{style:{color:"#000000"},href:"/todo/".concat(i),children:t})}),Object(g.jsx)(D.a.Subtitle,{children:Object(g.jsxs)("i",{style:{color:"#000000"},children:["Created by ",Object(g.jsx)("b",{children:c})]})}),Object(g.jsx)(D.a.Text,{children:k}),Object(g.jsx)("input",{type:"checkbox",checked:s,onChange:function(e){E(i,e.target.checked)}}),u&&Object(g.jsx)(m.a,{variant:"blank",href:"/todo/".concat(i),style:{backgroundColor:"#94b0ab"},children:"View Full Content"}),Object(g.jsx)(m.a,{variant:"blank",onClick:function(){v(i)},style:{backgroundColor:"#94b0f1"},children:"Delete Todo"}),s&&Object(g.jsxs)("i",{children:["Completed on: ",new Date(r).toLocaleDateString("en-us")]})]})})}var F=c.a.memo(R);var I=function(){var e=Object(n.useContext)(O.a).state.todos;return Object(g.jsx)("div",{children:e.map((function(e,t){return Object(n.createElement)(F,Object(h.a)(Object(h.a)({},e),{},{short:!0,title:e.title,author:e.author,content:e.content,key:"todo-"+t,todoId:e._id}))}))})};var B=function(){var e=Object(n.useContext)(O.a),t=e.state,a=e.dispatch,c=Object(f.b)((function(){return{url:"/todo",method:"get",headers:{Authorization:"".concat(t.user.access_token)}}})),r=Object(o.a)(c,2),s=r[0],i=r[1];Object(n.useEffect)((function(){t.user.access_token&&i()}),[]),Object(n.useEffect)((function(){i()}),[t.user.access_token]),Object(n.useEffect)((function(){s&&!1===s.isLoading&&s.data&&a({type:"FETCH_TODOS",todos:s.data.todos})}),[s]),s.data;var d=s.isLoading;return Object(g.jsxs)(g.Fragment,{children:[d&&"Todos loading..."," ",Object(g.jsx)(I,{})]})};var H=function(e){var t=e.id,a=Object(n.useContext)(O.a).state,c=Object(f.b)((function(){return{url:"/todo/".concat(t),headers:{Authorization:"".concat(a.user.access_token)},method:"get"}})),r=Object(o.a)(c,2),s=r[0],i=r[1];return Object(n.useEffect)(i,[t]),Object(g.jsxs)("div",{children:[s&&s.data?Object(g.jsx)(F,Object(h.a)({},s.data)):"Loading...",Object(g.jsx)("div",{children:Object(g.jsx)(y.a,{href:"/",children:"Go Back"})})]})};function U(e){var t=e.username,a=e.userId;return Object(g.jsx)(D.a,{children:Object(g.jsx)(D.a.Body,{children:Object(g.jsxs)(D.a.Title,{children:["Username:",Object(g.jsx)(y.a,{style:{color:"#000000"},href:"/users/".concat(a),children:t})]})})})}var G=c.a.memo(U),A=a(71);var z=function(){var e=Object(A.useContext)(O.a).state.users;return Object(g.jsx)("div",{children:e.map((function(e,t){return Object(n.createElement)(G,Object(h.a)(Object(h.a)({},e),{},{username:e.username,userId:e._id,key:"user-"+t}))}))})};var N=function(){var e=Object(n.useContext)(O.a),t=(e.state,e.dispatch),a=Object(f.b)((function(){return{url:"/users",method:"get"}})),c=Object(o.a)(a,2),r=c[0],s=c[1];Object(n.useEffect)(s,[]),Object(n.useEffect)((function(){r&&r.data&&t({type:"FETCH_USERS",users:r.data.users})}),[r]);var i=r.isLoading;return Object(g.jsxs)(g.Fragment,{children:[i&&"Users Loading..."," ",Object(g.jsx)(z,{})]})};var P=function(e){var t=e.id,a=Object(n.useContext)(O.a).dispatch,c=Object(f.b)((function(){return{url:"/users/".concat(t),method:"get"}})),r=Object(o.a)(c,2),s=r[0],i=r[1];Object(n.useEffect)(i,[t]);var d=Object(f.b)((function(){return{url:"/todos",method:"get"}})),u=Object(o.a)(d,2),j=u[0],l=u[1];return Object(n.useEffect)(l,[]),Object(n.useEffect)((function(){j&&j.data&&a({type:"FETCH_TODOS",todos:j.data})}),[j]),console.log("todos are "+j),j.isLoading,Object(n.useEffect)((function(){s&&a({type:"FETCH_TODOS_BY_USER",author:s.data})}),[j]),Object(g.jsxs)("div",{children:[Object(g.jsx)(m.a,{style:{marginTop:5,marginBottom:5},href:"/users",children:"Back to User List"}),s&&s.data?Object(g.jsx)(G,Object(h.a)({},s.data)):"Loading",Object(g.jsx)(I,{})]})};var Y=function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)(""),s=Object(o.a)(r,2),i=s[0],d=s[1],u=Object(n.useContext)(O.a),j=u.state,l=u.dispatch,b=j.user,h=Object(f.b)((function(e){var t=e.title,a=e.content,n=e.author;return{url:"/todo",method:"post",headers:{Authorization:"".concat(j.user.access_token)},data:{title:t,content:a,author:n}}})),x=Object(o.a)(h,2),p=x[0],m=x[1],v=Object(y.d)();return Object(n.useEffect)((function(){p&&p.data&&(l({type:"CREATE_TODO",title:p.data.title,content:p.data.content,id:p.data.id,author:b.username}),v.navigate("/todo/".concat(p.data.id)))}),[p]),Object(g.jsxs)("form",{onSubmit:function(e){e.preventDefault(),m({title:a,content:i,author:b.username})},children:[Object(g.jsxs)("div",{children:["Author: ",Object(g.jsx)("b",{children:b.username})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("label",{htmlFor:"create-title",children:"Title: "}),Object(g.jsx)("input",{type:"text",value:a,onChange:function(e){c(e.target.value)},name:"create-title",id:"create-title"})]}),Object(g.jsx)("textarea",{value:i,onChange:function(e){d(e.target.value)}}),Object(g.jsx)("input",{type:"submit",value:"Create"})]})};a(102);var J=function(){var e=Object(n.useState)({primaryColor:"deepskyblue",secondaryColor:"coral"}),t=Object(o.a)(e,2),a=t[0],c=t[1],r=Object(i.f)({"/":Object(i.g)({view:Object(g.jsx)(B,{})}),"/todo/create":Object(i.g)({view:Object(g.jsx)(Y,{})}),"/todo/:id":Object(i.g)((function(e){return{view:Object(g.jsx)(H,{id:e.params.id})}})),"/users":Object(i.g)({view:Object(g.jsx)(N,{})}),"/users/:id":Object(i.g)((function(e){return{view:Object(g.jsx)(P,{id:e.params.id})}}))}),s=Object(n.useReducer)(b,{user:{},todos:[],users:[]}),d=Object(o.a)(s,2),u=d[0],j=d[1];return u.user,Object(g.jsx)("div",{children:Object(g.jsx)(O.b.Provider,{value:a,children:Object(g.jsx)(O.a.Provider,{value:{state:u,dispatch:j},children:Object(g.jsx)(y.b,{routes:r,children:Object(g.jsxs)(E.a,{children:[Object(g.jsx)(L,{setTheme:c}),Object(g.jsx)("br",{}),Object(g.jsx)(y.c,{})]})})})})})},M=a(37),V=a.n(M),q=a.p+"static/media/bg1.c49fa194.jpg",K=V.a.create({baseURL:"/"}),Q={width:"100vw",height:"100vh",backgroundImage:"url(".concat(q,")"),backgroundSize:"cover"};s.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(f.a,{value:K,children:Object(g.jsx)("div",{style:Q,children:Object(g.jsx)(J,{})})})}),document.getElementById("root"))},77:function(e,t,a){},8:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s}));var n=a(0),c=a.n(n),r=c.a.createContext({primaryColor:"#5da2d5",secondaryColor:"#19181a"}),s=c.a.createContext({state:{},dispatch:function(){}})}},[[103,1,2]]]);
//# sourceMappingURL=main.dbf1e8ff.chunk.js.map